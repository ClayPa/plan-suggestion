import React, { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";

const hostingPlans = [
  {
    id: "shared",
    name: "Shared Hosting",
    url: "https://www.accuwebhosting.com/web-hosting/linux",
    description: "Ideal for small e-learning platforms and educators on a budget.",
    match: (answers) => {
      return (
        answers.students === "<50" &&
        answers.ram === "1 GB" &&
        answers.budget === "<$5/mo"
      );
    },
  },
  {
    id: "wordpress",
    name: "Managed WordPress Hosting",
    url: "https://www.accuwebhosting.com/web-hosting/wordpress",
    description: "Perfect for LMS platforms built on WordPress like LearnDash or LifterLMS.",
    match: (answers) => {
      return (
        answers.platform === "WordPress" &&
        answers.students === "50‚Äì200" &&
        answers.ram === "2‚Äì4 GB"
      );
    },
  },
  {
    id: "vps",
    name: "VPS Hosting",
    url: "https://www.accuwebhosting.com/vps-hosting",
    description: "Best for growing LMS platforms needing dedicated resources.",
    match: (answers) => {
      return (
        answers.students === "200‚Äì500" ||
        (answers.budget === "$10‚Äì$50/mo" && answers.ram === "4‚Äì8 GB")
      );
    },
  },
  {
    id: "dedicated",
    name: "Dedicated Server",
    url: "https://www.accuwebhosting.com/dedicated-servers",
    description: "Great for enterprise LMS platforms and mission-critical applications.",
    match: (answers) => {
      return (
        answers.students === ">1000" ||
        answers.ram === ">8 GB"
      );
    },
  },
];

const HostingSelector = () => {
  const [answers, setAnswers] = useState({});
  const [suggestion, setSuggestion] = useState(null);

  const handleSelect = (key, value) => {
    const updated = { ...answers, [key]: value };
    setAnswers(updated);
    const matchedPlan = hostingPlans.find((plan) => plan.match(updated));
    setSuggestion(matchedPlan);
  };

  return (
    <Card className="p-4 max-w-3xl mx-auto mt-6">
      <CardContent>
        <h2 className="text-xl font-semibold mb-4">üîç Find the Right LMS Hosting</h2>
        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <Label>How many students do you expect?</Label>
            <Select onValueChange={(val) => handleSelect("students", val)}>
              <SelectTrigger><SelectValue placeholder="Select student range" /></SelectTrigger>
              <SelectContent>
                <SelectItem value="<50">Less than 50</SelectItem>
                <SelectItem value="50‚Äì200">50‚Äì200</SelectItem>
                <SelectItem value="200‚Äì500">200‚Äì500</SelectItem>
                <SelectItem value=">1000">More than 1000</SelectItem>
              </SelectContent>
            </Select>
          </div>

          <div>
            <Label>Preferred platform?</Label>
            <Select onValueChange={(val) => handleSelect("platform", val)}>
              <SelectTrigger><SelectValue placeholder="Choose your LMS platform" /></SelectTrigger>
              <SelectContent>
                <SelectItem value="Moodle">Moodle</SelectItem>
                <SelectItem value="Chamilo">Chamilo</SelectItem>
                <SelectItem value="WordPress">WordPress (LearnDash, LifterLMS)</SelectItem>
                <SelectItem value="Other">Other</SelectItem>
              </SelectContent>
            </Select>
          </div>

          <div>
            <Label>Your expected RAM requirement?</Label>
            <Select onValueChange={(val) => handleSelect("ram", val)}>
              <SelectTrigger><SelectValue placeholder="Select RAM" /></SelectTrigger>
              <SelectContent>
                <SelectItem value="1 GB">1 GB</SelectItem>
                <SelectItem value="2‚Äì4 GB">2‚Äì4 GB</SelectItem>
                <SelectItem value="4‚Äì8 GB">4‚Äì8 GB</SelectItem>
                <SelectItem value=">8 GB">More than 8 GB</SelectItem>
              </SelectContent>
            </Select>
          </div>

          <div>
            <Label>What‚Äôs your monthly hosting budget?</Label>
            <Select onValueChange={(val) => handleSelect("budget", val)}>
              <SelectTrigger><SelectValue placeholder="Select your budget" /></SelectTrigger>
              <SelectContent>
                <SelectItem value="<$5/mo">Less than $5/month</SelectItem>
                <SelectItem value="$5‚Äì$10/mo">$5‚Äì$10/month</SelectItem>
                <SelectItem value="$10‚Äì$50/mo">$10‚Äì$50/month</SelectItem>
                <SelectItem value=">$50/mo">More than $50/month</SelectItem>
              </SelectContent>
            </Select>
          </div>
        </div>

        {suggestion && (
          <div className="mt-6 bg-blue-50 p-4 rounded-xl shadow">
            <h3 className="text-lg font-semibold">‚úÖ Suggested Hosting: {suggestion.name}</h3>
            <p className="mt-2 mb-4 text-gray-700">{suggestion.description}</p>
            <a href={suggestion.url} target="_blank" rel="noopener noreferrer">
              <Button className="bg-blue-600 text-white hover:bg-blue-700">View Plan</Button>
            </a>
          </div>
        )}
      </CardContent>
    </Card>
  );
};

export default HostingSelector;
